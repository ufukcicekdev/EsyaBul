{% extends 'partialsBase/base.html' %}
{% load custom_filters %}
{% load static %}
{% block title %} {{ category_name.name }} - Esyala {% endblock title %}
{% load social_share %}
{% block content %}

<style>



.star {
    cursor: pointer;
    font-size: 25px;
    color: rgb(168, 168, 168);
}

.selected {
    color: gold;
}


button{
  outline: none;
  cursor: pointer;
  font-weight: 500;
  border-radius: 4px;
  border: 2px solid transparent;
  transition: background 0.1s linear, border-color 0.1s linear, color 0.1s linear;
}


::selection{
  color: #fff;
  background: #7d2ae8;
}
.view-modal, .popupSocial{
  position: absolute;
  left: 50%;
  z-index: 5;
}

.view-modal{
  top: 10%;
  left: 90%;
  color: #e8e4ee;
  font-weight: bold;
  font-size: 18px;
  padding: 10px 25px;
  background: rgb(113, 5, 156);
  transform: translate(-50%, -50%);
}
.popupSocial{
  background: rgb(255, 254, 254);
  padding: 25px;
  border-radius: 15px;
  top: 10%;
  max-width: 380px;
  width: 100%;
  opacity: 0;
  pointer-events: none;
  box-shadow: 0px 10px 15px rgba(0,0,0,0.1);
  transform: translate(-50%, -50%) scale(1.2);
  transition: top 0s 0.2s ease-in-out,
              opacity 0.2s 0s ease-in-out,
              transform 0.2s 0s ease-in-out;
}
.popupSocial.show{
  top: 300%;
  left: 100%;
  opacity: 1;
  pointer-events: auto;
  transform:translate(-50%, -50%) scale(1);
  transition: top 0s 0s ease-in-out,
              opacity 0.2s 0s ease-in-out,
              transform 0.2s 0s ease-in-out;

}
.popupSocial :is(header, .icons, .field){
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.popupSocial header{
  padding-bottom: 15px;
  border-bottom: 1px solid #ebedf9;
}
header span{
  font-size: 21px;
  font-weight: 600;
}
header .close, .icons a{
  display: flex;
  align-items: center;
  border-radius: 50%;
  justify-content: center;
  transition: all 0.3s ease-in-out;
} 
header .close{
  color: #878787;
  font-size: 17px;
  background: #f3f3f3;
  height: 33px;
  width: 33px;
  cursor: pointer;
}
header .close:hover{
  background: #ebedf9;
}
.popup .sociaContent{
  margin: 20px 0;
}
.popup .icons{
  margin: 15px 0 20px 0;
}
.sociaContent p{
  font-size: 16px;
}
.sociaContent .icons a{
  height: 50px;
  width: 50px;
  font-size: 20px;
  text-decoration: none;
  border: 1px solid transparent;
}
.icons a i{
  transition: transform 0.3s ease-in-out;
}
.icons a:nth-child(1){
  color: #1877F2;
  border-color: #b7d4fb;
}
.icons a:nth-child(1):hover{
  background: #1877F2;
}
.icons a:nth-child(2){
  color: #46C1F6;
  border-color: #b6e7fc;
}
.icons a:nth-child(2):hover{
  background: #46C1F6;
}
.icons a:nth-child(3){
  color: #e1306c;
  border-color: #f5bccf;
}
.icons a:nth-child(3):hover{
  background: #e1306c;
}
.icons a:nth-child(4){
  color: #25D366;
  border-color: #bef4d2;
}
.icons a:nth-child(4):hover{
  background: #25D366;
}
.icons a:nth-child(5){
  color: #0088cc;
  border-color: #b3e6ff;
}
.icons a:nth-child(5):hover{
  background: #0088cc;
}
.icons a:hover{
  color: #fff;
  border-color: transparent;
}
.icons a:hover i{
  transform: scale(1.2);
}
.sociaContent .field{
  margin: 12px 0 -5px 0;
  height: 45px;
  border-radius: 4px;
  padding: 0 5px;
  border: 1px solid #757171;
}
.field.active{
  border-color: #7d2ae8;
}
.field i{
  width: 50px;
  font-size: 18px;
  text-align: center;
}
.field.active i{
  color: #7d2ae8;
}


.field input{
  width: 100%;
  height: 100%;
  border: none;
  outline: none;
  font-size: 15px;
}
.field button{
  color: #fff;
  padding: 5px 18px;
  background: #7d2ae8;
}
.field button:hover{
  background: #8d39fa;
}


@media only screen and (max-width: 798px) {
    .popupSocial.show {
    top: 300%;
    left: 100%;
    opacity: 1;
    pointer-events: auto;
    transform: translate(-93%, -50%) scale(0.80);
    transition: top 0s 0s ease-in-out, opacity 0.2s 0s ease-in-out, transform 0.2s 0s ease-in-out;
}


}

/* Diğer sosyal medya platformları için aynı şekilde devam edebilirsiniz */

</style>



<div id="wrapper">
    <!-- Page Loader -->
    <div id="pre-loader" class="loader-container">
        <div class="loader">
            <img src="{% static 'basestatic/images/svg/rings.svg' %}" alt="loader">
        </div>
    </div>
    <!-- W1 start here -->
    <div class="w1">
        <!-- mt header style4 start here -->
        {% include 'coreBase/header.html' %}
        <!-- mt header style4 end here -->
        <!-- mt side menu start here -->
    
        <main id="mt-main">
            <!-- Mt Contact Banner of the Page -->
            <section class="mt-contact-banner style4" style="background-image: url({% static 'basestatic/images/img-76.jpg' %});">
                <div class="container">
                    <div class="row">
                        <div class="col-xs-12 text-center">
                            <h1>{{ category_name.name }}</h1>
                            <!-- Breadcrumbs of the Page -->
                            <nav class="breadcrumbs">
                                <ul class="list-unstyled">
                                    <li><a href="{% url 'main:home' %}">AnaSayfa <i class="fa fa-angle-right"></i></a></li>
                                    <li><a href="#">Ürünler <i class="fa fa-angle-right"></i></a></li>
                                    <li>{{ category_name.name }}</li>
                                </ul>
                            </nav><!-- Breadcrumbs of the Page end -->
                        </div>
                    </div>
                </div>
            </section><!-- Mt Contact Banner of the Page end -->
            <div class="container">
                <div class="row">
                    <!-- sidebar of the Page start here -->
                    <aside id="sidebar" class="col-xs-12 col-sm-4 col-md-3 wow fadeInLeft" data-wow-delay="0.4s">
                    
                        <!-- shop-widget of the Page start here -->
                        <section class="shop-widget">
                            <h2>Kategoriler</h2>
                            <!-- category list start here -->
                            <ul class="list-unstyled category-list">
                                {% for subcategory in subcategories %}
                                    <li>
                                        <a href="{% url 'main:dynamic-category-product-list' category_slugs=category.slug|add:'/'|add:subcategory.slug %}">
                                            <span class="name">{{ subcategory.name }}</span>
                                            <span class="num">{{ subcategory.product_count }}</span>
                                        </a>
                                    </li>
                                {% endfor %}
                                
                            </ul><!-- category list end here -->
                            <ul class="list-unstyled category-list">
                                {% for category in main_categories1 %}
                                <li>
                                    <a href="{% url 'main:dynamic-category-product-list' category_slugs=category.slug %}"><span class="name">{{ category.name }}</span></a>
                                    
                                </li>
                                {% endfor %}
                            </ul>
                            
                            
                            
                        </section><!-- shop-widget of the Page end here -->

                        
                    </aside><!-- sidebar of the Page end here -->
                    <div class="col-xs-12 col-sm-8 col-md-9 wow fadeInRight" data-wow-delay="0.4s">
                        <!-- mt shoplist header start here -->
                        <header class="mt-shoplist-header">
                            <!-- btn-box start here -->
                            <div class="btn-box">
                                <ul class="list-inline">
                                    <li>
                                        <a href="#" class="drop-link">
                                            Default Sorting <i aria-hidden="true" class="fa fa-angle-down"></i>
                                        </a>
                                        <div class="drop">
                                            <ul class="list-unstyled">
                                                <li><a href="#">ASC</a></li>
                                                <li><a href="#">DSC</a></li>
                                                <li><a href="#">Price</a></li>
                                                <li><a href="#">Relevance</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li><a class="mt-viewswitcher" href="#"><i class="fa fa-th-large" aria-hidden="true"></i></a></li>
                                    <li><a class="mt-viewswitcher" href="#"><i class="fa fa-th-list" aria-hidden="true"></i></a></li>
                                </ul>
                            </div><!-- btn-box end here -->
                            <!-- mt-textbox start here -->
                            <div class="mt-textbox">
                                <p><strong>{{ products.count }}</strong> sonuç</p>
                            </div><!-- mt-textbox end here -->
                        </header><!-- mt shoplist header end here -->
                        <!-- mt productlisthold start here -->
                        <ul class="mt-productlisthold list-inline">
                            
                            {% for product in products %}
                            <li>
                                <!-- mt product2 start here -->
                                <div class="mt-product2 large bg-grey">
                                    <!-- box start here -->
                                    <div class="box">
                                        {% with first_image=product.related_products.first %}
                                                {% if first_image %}
                                                <a href="{% url 'products:product-detail-view' product.slug %}"><img src="{{ first_image.image.url }}" alt="{{ first_image.img_title }}"></a>
                                                {% endif %}
                                        {% endwith %}
                                        

                                        {% if product.get_precentage != None %}
                                        <span class="caption">
                                            <span class="off">{{product.get_precentage|floatformat:0}}%</span>
                                        </span>
                                        {% endif %}

                                        <ul class="mt-stars">
                                            {% if product.average_rating %}
                                            {% for star in product.average_rating|make_star_list %}
                                            <li><i class="fa fa-star{% if not star %}-o{% endif %}"></i></li>
                                            {% endfor %}
                                            {% endif %}
                                        </ul>
                                        <ul class="links">
                                            {% if request.user.is_authenticated %}
                                                <li><a href="#"><i class="icon-handbag"></i></a></li>
                                            {% endif %}
                                            {% if request.user.is_authenticated %}
                                                <li><a  aria-label="Beğendiklerim" class="action-btn add-to-wishlist" data-product-item="{{product.id}}" href="#"><i class="icon-heart"></i></a></li>
                                            {% endif %}
                                            <li><a href="#popup{{product.id}}" class="lightbox" ><i class="icomoon icon-eye"></i></a></li>

                                        </ul>
                                    </div><!-- box end here -->
                                    <!-- txt end here -->

                                    <div class="txt">
                                        <strong class="title">{{ product.name }}</strong>
                                        {% if product.selling_old_price is not null %}
                                        <del class="off"><i class="fa fa-try"></i> <span>{{product.selling_old_price}}</span></del>
                                        {% endif %}
                                        <span class="price"><i class="fa fa-try"></i> <span>{{product.selling_price}}</span></span>
                                    </div><!-- txt end here -->
                                </div><!-- mt product2 end here -->
                            </li>
                            
                            
                            {% endfor %}
                            
                            
                            
                        </ul><!-- mt productlisthold end here -->
                        <!-- mt pagination start here -->
                        <nav class="mt-pagination">
                            <ul class="list-inline">
                                <li><a href="#">1</a></li>
                                <li><a href="#">2</a></li>
                                <li><a href="#">3</a></li>
                                <li><a href="#">4</a></li>
                            </ul>
                        </nav><!-- mt pagination end here -->
                    </div>
                </div>
            </div>
        </main><!-- mt main end here -->
        <!-- footer of the Page -->
        {% include 'coreBase/footer.html' %}
        <!-- footer of the Page end -->
    </div><!-- W1 end here -->
    <span id="back-top" class="fa fa-arrow-up"></span>
</div>



<div class="popup-holder">
    <!-- Popup of the Page -->
    {% for product in products %}
    <div id="popup{{product.id}}" class="lightbox" style="display: none;">
        <!-- Mt Product Detial of the Page -->
        <section class="mt-product-detial">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12">
                        <!-- Slider of the Page -->
                        <div class="slider">
                            <!-- Comment List of the Page -->
                            <ul class="list-unstyled comment-list">
                                <li><a href="#"><i class="fa fa-heart"></i>{{ product.wishes.count }}</a></li>
                                <li><a href="#"><i class="fa fa-comments"></i>{{ product.reviews.count }}</a></li>
                                <li><a href="#" class="share-modal"><i class="fa fa-share-alt"></i> Paylaş</a></li>
                            </ul><!-- Comment List of the Page end -->

                            <div class="popupSocial">
                                <header>
                                    <span>Paylaşım Penceresi</span>
                                    <div class="close"><i class="uil uil-times"></i></div>
                                </header>
                                <div class="sociaContent">
                                    <p>Bu linki paylaşın:</p>
                                    <ul class="icons">
                                        <li><a href="#" id="facebookShareBtn"><i class="fab fa-facebook-f"></i></a></li>
                                        <li><a href="#" id="twitterShareBtn"><i class="fab fa-twitter"></i></a></li>
                                        <li><a href="#" id="linkedinShareBtn"><i class="fab fa-linkedin"></i></a></li>
                                        <li><a href="#" id="whatsappShareBtn"><i class="fab fa-whatsapp"></i></a></li>
                                        <li><a href="#" id="telegramShareBtn"><i class="fab fa-telegram-plane"></i></a></li>
                                        <!-- Diğer sosyal medya platformları için benzer bağlantılar ekleyebilirsiniz -->
                                    </ul>
                                    <p>Veya linki kopyalayın:</p>
                                    <div class="field">
                                        <i class="url-icon uil uil-link"></i>
                                        <input type="text" readonly value="{{ request.build_absolute_uri }}">
                                        <button>Kopyala</button>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        <!-- Slider of the Page end -->
                        <!-- Detail Holder of the Page -->
                        <div class="detial-holder">
                            <!-- Breadcrumbs of the Page -->
                            <ul class="list-unstyled breadcrumbs">
                                    <li class="breadcrumb-item">{{ product.get_category_breadcrumb }}</li>
                                
                            </ul>
                            <!-- Breadcrumbs of the Page end -->
                            <h2>{{ product.name }}</h2>
                            <!-- Rank Rating of the Page -->
                            <div class="rank-rating">
                                <ul class="list-unstyled rating-list">
                                    {% if product.average_rating %}
                                    {% for star in product.average_rating|make_star_list %}
                                    <li><i class="fa fa-star{% if not star %}-o{% endif %}"></i></li>
                                    {% endfor %}
                                    {% endif %}
                                </ul>
                                <span class="total-price">Yorumlar ({{ product.reviews.count }})</span>
                            </div><!-- Rank Rating of the Page end -->
                            <ul class="list-unstyled list">                                
                                {% if request.user.is_authenticated %}
                                    <li><a  aria-label="Beğendiklerim" class="action-btn add-to-wishlist" data-product-item="{{product.id}}" href="#"><i class="icon-heart"></i></a></li>
                                {% endif %}
                            </ul>
                            <div class="txt-wrap">
                                <p>{{ product.description }}</p>
                            </div>
                            <div class="text-holder">
                                {% if product.selling_old_price is not null %}
                                        <del class="off"><i class="fa fa-try"></i> <span>{{product.selling_old_price}}</span></del>
                                        {% endif %}
                                        <span class="price"><i class="fa fa-try"></i> <span>{{product.selling_price}}</span></span>
                            </div><!-- Product Form of the Page -->
                            <form action="#" class="product-form">
                                <fieldset>
                                    <div class="row-val">
                                        <label for="qty">qty</label>
                                        <select id="clr">
                                            <option>1</option>
                                        </select>
                                    </div>
                                    <div class="row-val">
                                        <button type="submit">ADD TO CART</button>
                                    </div>
                                </fieldset>
                            </form><!-- Product Form of the Page end -->
                        </div><!-- Detail Holder of the Page end -->
                    </div>
                </div>
            </div>
        </section><!-- Mt Product Detial of the Page end -->
    </div>
    {% endfor %}

    <!-- Diğer modallar buraya eklenebilir -->
</div>




<script>

const viewBtn = document.querySelector(".share-modal");
const popup = document.querySelector(".popupSocial");
const close = popup.querySelector(".close");
const field = popup.querySelector(".field");
const input = field.querySelector("input");
const copy = field.querySelector("button");

viewBtn.addEventListener("click", function(event) {
    event.preventDefault();
    popup.classList.toggle("show");
});

close.addEventListener("click", function(event) {
    event.preventDefault();
    popup.classList.remove("show");
});

copy.addEventListener("click", function(event) {
    event.preventDefault();
    input.select(); // Select the input value
    if (document.execCommand("copy")) { // If the selected text is copied
        field.classList.add("active");
        copy.innerText = "Kopyalandı";
        setTimeout(function() {
            window.getSelection().removeAllRanges(); // Remove selection from page
            field.classList.remove("active");
            copy.innerText = "Kopyala";
        }, 3000);
    }
});


document.getElementById("facebookShareBtn").addEventListener("click", function() {
    var url = "https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(window.location.href);
    window.open(url, "_blank", "width=600,height=400");
});

document.getElementById("twitterShareBtn").addEventListener("click", function() {
    var url = "https://twitter.com/intent/tweet?url=" + encodeURIComponent(window.location.href);
    window.open(url, "_blank", "width=600,height=400");
});

document.getElementById("linkedinShareBtn").addEventListener("click", function() {
    var url = "https://www.linkedin.com/sharing/share-offsite/?url=" + encodeURIComponent(window.location.href);
    window.open(url, "_blank", "width=600,height=400");
});

document.getElementById("whatsappShareBtn").addEventListener("click", function() {
    var url = "https://api.whatsapp.com/send?text=" + encodeURIComponent(window.location.href);
    window.open(url, "_blank", "width=600,height=400");
});

document.getElementById("telegramShareBtn").addEventListener("click", function() {
    var url = "https://t.me/share/url?url=" + encodeURIComponent(window.location.href);
    window.open(url, "_blank", "width=600,height=400");
});

</script>


{% endblock %}




