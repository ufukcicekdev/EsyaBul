{% extends 'partialsBase/base.html' %}
{% load custom_filters %}
{% load static %}
{% block title %} {{ category_name.name }} - Eşyala {% endblock title %}
{% block description %} {{ category_name.description }} {% endblock description %}

{% load social_share %}
{% block content %}

<style>



.star {
    cursor: pointer;
    font-size: 25px;
    color: rgb(168, 168, 168);
}

.selected {
    color: gold;
}


button{
  outline: none;
  cursor: pointer;
  font-weight: 500;
  border-radius: 4px;
  border: 2px solid transparent;
  transition: background 0.1s linear, border-color 0.1s linear, color 0.1s linear;
}


::selection{
  color: #fff;
  background: #7d2ae8;
}
.view-modal, .popupSocial{
  position: absolute;
  left: 50%;
  z-index: 5;
}

.view-modal{
  top: 10%;
  left: 90%;
  color: #e8e4ee;
  font-weight: bold;
  font-size: 18px;
  padding: 10px 25px;
  background: rgb(113, 5, 156);
  transform: translate(-50%, -50%);
}
.popupSocial{
  background: rgb(255, 254, 254);
  padding: 25px;
  border-radius: 15px;
  top: 10%;
  max-width: 380px;
  width: 100%;
  opacity: 0;
  pointer-events: none;
  box-shadow: 0px 10px 15px rgba(0,0,0,0.1);
  transform: translate(-50%, -50%) scale(1.2);
  transition: top 0s 0.2s ease-in-out,
              opacity 0.2s 0s ease-in-out,
              transform 0.2s 0s ease-in-out;
}
.popupSocial.show{
  top: 300%;
  left: 100%;
  opacity: 1;
  pointer-events: auto;
  transform:translate(-50%, -50%) scale(1);
  transition: top 0s 0s ease-in-out,
              opacity 0.2s 0s ease-in-out,
              transform 0.2s 0s ease-in-out;

}
.popupSocial :is(header, .icons, .field){
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.popupSocial header{
  padding-bottom: 15px;
  border-bottom: 1px solid #ebedf9;
}
header span{
  font-size: 21px;
  font-weight: 600;
}
header .close, .icons a{
  display: flex;
  align-items: center;
  border-radius: 50%;
  justify-content: center;
  transition: all 0.3s ease-in-out;
} 
header .close{
  color: #878787;
  font-size: 17px;
  background: #f3f3f3;
  height: 33px;
  width: 33px;
  cursor: pointer;
}
header .close:hover{
  background: #ebedf9;
}
.popup .sociaContent{
  margin: 20px 0;
}
.popup .icons{
  margin: 15px 0 20px 0;
}
.sociaContent p{
  font-size: 16px;
}
.sociaContent .icons a{
  height: 50px;
  width: 50px;
  font-size: 20px;
  text-decoration: none;
  border: 1px solid transparent;
}
.icons a i{
  transition: transform 0.3s ease-in-out;
}
.icons a:nth-child(1){
  color: #1877F2;
  border-color: #b7d4fb;
}
.icons a:nth-child(1):hover{
  background: #1877F2;
}
.icons a:nth-child(2){
  color: #46C1F6;
  border-color: #b6e7fc;
}
.icons a:nth-child(2):hover{
  background: #46C1F6;
}
.icons a:nth-child(3){
  color: #e1306c;
  border-color: #f5bccf;
}
.icons a:nth-child(3):hover{
  background: #e1306c;
}
.icons a:nth-child(4){
  color: #25D366;
  border-color: #bef4d2;
}
.icons a:nth-child(4):hover{
  background: #25D366;
}
.icons a:nth-child(5){
  color: #0088cc;
  border-color: #b3e6ff;
}
.icons a:nth-child(5):hover{
  background: #0088cc;
}
.icons a:hover{
  color: #fff;
  border-color: transparent;
}
.icons a:hover i{
  transform: scale(1.2);
}
.sociaContent .field{
  margin: 12px 0 -5px 0;
  height: 45px;
  border-radius: 4px;
  padding: 0 5px;
  border: 1px solid #757171;
}
.field.active{
  border-color: #7d2ae8;
}
.field i{
  width: 50px;
  font-size: 18px;
  text-align: center;
}
.field.active i{
  color: #7d2ae8;
}


.field input{
  width: 100%;
  height: 100%;
  border: none;
  outline: none;
  font-size: 15px;
}
.field button{
  color: #fff;
  padding: 5px 18px;
  background: #7d2ae8;
}
.field button:hover{
  background: #8d39fa;
}


@media only screen and (max-width: 798px) {
    .popupSocial.show {
    top: 300%;
    left: 100%;
    opacity: 1;
    pointer-events: auto;
    transform: translate(-93%, -50%) scale(0.80);
    transition: top 0s 0s ease-in-out, opacity 0.2s 0s ease-in-out, transform 0.2s 0s ease-in-out;
}


}


.subcategory-list .name {
  font-size: 16px;
  line-height: 18px;
  font-weight: 700;
}

.subcategory-list .num {
  float: right;
  font-weight: 400;
  font-size: 13px;
  line-height: 15px;
  margin: 2px 0 0;
}

.sub-subcategory-list {
    display: none; /* Alt kategorileri varsayılan olarak gizle */
}

.subcategory-list li {
    list-style: none; /* Madde işaretlerini kaldır */
    margin: 10px 0; /* Liste öğeleri arasındaki boşluğu ayarla */
}

.subcategory-list li:hover .sub-subcategory-list {
    display: block; /* Üzerine gelindiğinde alt kategorileri göster */
}





</style>

<style>
  #card-view {
    display: inline-table;
    flex-wrap: wrap;
    gap: 10px; /* Kartlar arasındaki boşluk */
}

.product-3 {
    display: flex;
    flex-direction: column;
    border: 1px solid #ddd;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    height: 500px; /* Sabit yükseklik */
    overflow: hidden; /* İçeriğin dışarı taşmasını önler */
    position: relative;
    text-align: center;
    background-color: #fff; /* Arka plan rengi */
}

.img {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 300px; /* Sabit yükseklik */
    overflow: hidden; /* Taşmaları önler */
    position: relative; /* Caption ve yıldızlar için gerekli */
}

.img img {
    max-width: 100%;
    max-height: 100%;
}

.caption {
    position: absolute;
    bottom: 10px;
    left: 10px;
    color: #fff;
    padding: 5px;
}

.caption .off {
    font-size: 17px;
    color: #fff;
    display: inline-block;
    padding: 3px 8px;
    margin-bottom: 5px;
    background-color: #b2cc29;
    font-weight: 700;
    font-family: "Montserrat", sans-serif;
    line-height: 1.2;
    border-radius: 3px;
}

.caption .best-price {
    font-size: 17px;
    color: #fff;
    padding: 5px 10px;
    background-color: #fed062;
    font-weight: 700;
    font-family: "Montserrat", sans-serif;
    line-height: 1.2;
    border-radius: 3px;
    display: inline-block;
}

.mt-stars-container {
    margin-top: 10px;
}

.mt-stars {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: center;
}

.mt-stars li {
    margin: 0 2px;
}

.mt-stars i {
    color: #FFD700;
}

.title a {
    color: #000;
    text-decoration: none;
}

.price, .off {
    display: block;
}

.links {
    list-style: none;
    padding: 0;
    margin: 10px 0;
    display: flex;
    justify-content: center;
}

.links li {
    margin: 0 5px;
}


</style>



<div id="wrapper">
    <!-- Page Loader -->
    <!-- <div id="pre-loader" class="loader-container">
        <div class="loader">
            <img src="{% static 'images/svg/rings.svg' %}" alt="loader">
        </div>
    </div> -->
    <!-- W1 start here -->
    <div class="w1">
        <!-- mt header style4 start here -->
        {% include 'coreBase/header.html' %}
        <!-- mt header style4 end here -->
        <!-- mt side menu start here -->
    
        <main id="mt-main">
            <!-- Mt Contact Banner of the Page -->
            <section class="mt-contact-banner style4" style="background-image: url({% static 'images/img-76.jpg' %});">
                <div class="container">
                    <div class="row">
                      <div class="col-xs-12 text-center">
                        <h1 style="color: #fff;">{{ category_name.name }}</h1>
                        <!-- Kategori açıklaması -->
                        <p style="color: #fff; font-size: 16px; margin-top: 10px;">
                            {% if category_name.description %}
                                {{ category_name.description }}
                            {% endif %}
                        </p>
                        <!-- Breadcrumbs of the Page -->
                        <nav class="breadcrumbs">
                            <ul class="list-unstyled">
                                <li><a style="color: #fff;" href="{% url 'main:home' %}">Anasayfa <i class="fa fa-angle-right"></i></a></li>
                                <li><a style="color: #fff;" href="{% url 'main:dynamic-category-product-list' category_slugs=main_slug.slug %}">{{ main_slug.name }}<i class="fa fa-angle-right"></i></a></li>
                                {% if main_slug.name != category_name.name %}
                                    <li style="color: #fff;">{{ category_name.name }}</li>
                                {% endif %}
                            </ul>
                        </nav><!-- Breadcrumbs of the Page end -->
                    </div>
                    
                    </div>
                </div>
            </section><!-- Mt Contact Banner of the Page end -->
            <div class="container">
                <div class="row">
                    <!-- sidebar of the Page start here -->
                    <aside id="sidebar" class="col-xs-12 col-sm-4 col-md-3 wow fadeInLeft" data-wow-delay="0.4s">
                    
                        <!-- shop-widget of the Page start here -->
                        <section class="shop-widget">
                            <h2>Kategoriler</h2>
                            <!-- category list start here -->
                           
                            {% include 'core/sub_categories.html' with subcategories=subcategories %}
                            
                            {% if tumrunler %}
                            <ul class="list-unstyled category-list">
                              {% for category in main_categories %}
                              <li>
                                  <a href="{% url 'main:dynamic-category-product-list' category_slugs=category.slug %}"><span class="name">{{ category.name }}</span></a>
                                  
                              </li>
                              {% endfor %}
                          </ul>
                            {% endif %}
                            
                        </section><!-- shop-widget of the Page end here -->
                    </aside><!-- sidebar of the Page end here -->
                    <div class="col-xs-12 col-sm-8 col-md-9 wow fadeInRight"  data-wow-delay="0.4s">
                        <!-- mt shoplist header start here -->
                        <header class="mt-shoplist-header">
                            <!-- btn-box start here -->
                            <div class="btn-box">
                                
                            </div>
                            <!-- mt-textbox start here -->
                            <div class="mt-textbox">
                                <p><strong>{{ product_count }}</strong> sonuç</p>
                            </div><!-- mt-textbox end here -->
                        </header><!-- mt shoplist header end here -->
                        <!-- mt productlisthold start here -->
                        <ul class="mt-productlisthold list-inline" id="card-view">
                          {% for product in products %}
                          <li>
                              <div class="product-3 marginzero">
                                  <!-- img start here -->
                                  <div class="img">
                                      {% if product.related_products.count %}
                                          {% with first_image=product.related_products.first %}
                                              <a href="{% url 'products:product-detail-view' product.slug %}">
                                                  <img src="{{ first_image.image.url }}" alt="{{ first_image.img_title }}">
                                              </a>
                                          {% endwith %}
                                      {% endif %}
                      
                                      {% if product.get_percentage %}
                                      <span class="caption">
                                          <span class="off">{{ product.get_percentage|floatformat:0 }}%</span>
                                          <span class="best-price">En İyi Fiyat</span>
                                      </span>
                                      {% endif %}
                                  </div>
                      
                                  <!-- stars start here -->
                                  {% if product.get_star_list %}
                                  <div class="mt-stars-container">
                                      <ul class="mt-stars">
                                          {% for star in product.get_star_list %}
                                          <li><i class="fa fa-star{% if not star %}-o{% endif %}"></i></li>
                                          {% endfor %}
                                      </ul>
                                  </div>
                                  {% endif %}
                      
                                  <!-- txt start here -->
                                  <div class="txt">
                                      <strong class="title">
                                          <a href="{% url 'products:product-detail-view' product.slug %}">{{ product.name }}</a>
                                      </strong>
                                      {% if product.selling_old_price != 0 %}
                                      <del class="off"><i class="fa fa-try"></i> <span>{{product.selling_old_price}}</span></del>
                                      {% endif %}
                                      <span class="price"><i class="fa fa-try"></i> <span>{{product.selling_price}}</span></span>
                                      <p>{{ product.truncated_description }}</p>
                                  </div>
                      
                                  <!-- links start here -->
                                  <ul class="links">
                                      {% if request.user.is_authenticated %}
                                      <li><a aria-label="Beğendiklerim" class="action-btn add-to-wishlist" data-product-item="{{product.id}}" ><i class="icon-heart"></i></a></li>
                                      {% endif %}
                                      <li><a href="{% url 'products:product-detail-view' product.slug %}" class="lightbox"><i class="icon-eye"></i></a></li>
                                  </ul>
                              </div>
                          </li>
                          {% endfor %}
                      </ul>
                      
                      
                        
                        
                        

                        <nav aria-label="Page navigation">
                          <ul class="pagination justify-content-center">
                              {% if products.has_previous %}
                                  <li class="page-item">
                                      <a class="page-link" href="?page=1">&laquo; İlk</a>
                                  </li>
                                  <li class="page-item">
                                      <a class="page-link" href="?page={{ products.previous_page_number }}">Önceki</a>
                                  </li>
                              {% endif %}
                      
                              <li class="page-item">
                                  <span class="page-link">Sayfa {{ products.number }} / {{ products.paginator.num_pages }}</span>
                              </li>
                      
                              {% if products.has_next %}
                                  <li class="page-item">
                                      <a class="page-link" href="?page={{ products.next_page_number }}">Sonraki</a>
                                  </li>
                                  <li class="page-item">
                                      <a class="page-link" href="?page={{ products.paginator.num_pages }}">Son &raquo;</a>
                                  </li>
                              {% endif %}
                          </ul>
                      </nav>
                      
                    </div>
                </div>
            </div>
        </main><!-- mt main end here -->
        <!-- footer of the Page -->
        {% include 'coreBase/footer.html' %}
        <!-- footer of the Page end -->
    </div><!-- W1 end here -->
    <span id="back-top" class="fa fa-arrow-up"></span>
</div>



<script>



document.addEventListener("DOMContentLoaded", function() {
    const listViewBtn = document.getElementById('list-view-btn');
    const cardViewBtn = document.getElementById('card-view-btn');
    const listView = document.getElementById('list-view');
    const cardView = document.getElementById('card-view');

    listViewBtn.addEventListener('click', function() {
        listView.style.display = 'block';
        cardView.style.display = 'none';
    });

    cardViewBtn.addEventListener('click', function() {
        listView.style.display = 'none';
        cardView.style.display = 'block';
    });
});


// JavaScript ile alt kategorileri göstermek için bir fonksiyon
function toggleSubcategories(element) {
    var subcategories = element.querySelector('.sub-subcategory-list');
    if (subcategories.style.display === 'block') {
        subcategories.style.display = 'none';
    } else {
        subcategories.style.display = 'block';
    }
}

// Tıklama etkinliği eklemek için HTML'de onclick özniteliğini kullanabiliriz


</script>


{% endblock %}




